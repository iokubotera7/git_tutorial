## SSH
SSHクライアントに接続するユーザには公開鍵と秘密鍵を発行する。  
サーバが発行した公開鍵は~/.ssh/authorized_keysディレクトリに登録する。  
つまり、ユーザごとに発行した公開鍵は~/.ssh/authorized_keysに保管される  

公開鍵認証方式によるSSHは以下のとおりになる  

1. ユーザがSSHで使用する公開鍵と秘密鍵を生成する
2. ユーザの公開鍵をサーバに登録する（登録先は、~/.ssh/authorized_keys）
3. ユーザが秘密鍵で暗号化したデータをサーバに送る
4. サーバが登録されているユーザの公開鍵を使用して、復号する
5. 復号に成功したら、ログインを許可する  

## 仮想化
CPUの仮想化支援機能は以下がある  
そもそも、CPUの仮想化支援機能とは、仮想化ソフトウェアが行う処理の一部をCPUが分担することで処理を高速化すること。  

* Intel VT
* AMD-V

Dockerで、コンテナを強制的に停止するコマンドは 
docker kill コンテナ名  
である

## initプロセス
最初に起動するプロセスで、その他のプロセスたちを起動する役目をもっている。  
initプログラムには３種類ある。  
* SysVinit
* Upstart
* systemd

現在は、systemdが主流。  
SysVinitでは、設定ファイルとして「/etc/inittab」が使用される。  
Upstartやsystemdでは使用されていない  

## systemd
systemdでは、「Unit」という単位で処理を管理する。  
これまでのinitプロセス（init/upstart）ではサービスという単位で処理を管理しており、サービス起動はすべてシェルスクリプトで実装されていた  
しかし、上記ではお作法に従わないシェルスクリプトでは動作できなかったり、順番にシェルを実行するため起動時間が長いなどの欠点があった  

そこで、initやupstartで使用していた起動用のシェルスクリプトであるrc.sysinitやサービス起動用のスクリプトの内容をUnitという単位でsystemdでは定義
した。  

unitにはいくつか種類がある。  
* target：複数のunitファイルをまとめるために利用する
* service：指定のバイナリを実行する
* device：
* mount：指定のファイルシステムをマウントする

### Unitの依存関係
systemdが起動すると、default.targetをunitの頂点とする、依存関係のツリーが構築し、依存するUnitを起動していく  
それぞれのUnitには依存関係（AにはBが必要）の情報とは別に、起動順序（AはBの後に起動）についての設定が与えられる。  
起動順序の指定がない場合、Unitは並列で起動処理が行われる  


systemdでは、最初に起動するUnitは「/etc/systemd/system/default.target」であり、default.targetをSysVinitでのランレベルに相当する  
Unitへのシンボリックリンクを作成することで、期待するサービス群を起動できるようになる  

| ランレベル | ターゲット |
| - | - |
| 0 | poweroff.target |
| 1 | rescue.target |
| 2,3,4 | multi-user.target |
| 5 | graphical.target |
| 6 | reboot.target | 

また、メンテナンスのためシングルユーザモード(systemctl rescue)で作業し、通常の起動状態に戻したい場合、以下のコマンドで戻れる  

* Ctrl+D
* systemctl reboot 
* systemctl default

また、シングルユーザモードとは必要最小限のデーモンを起動し、パスワードを入力することなくrootユーザにログインするモードになる  
主に、メンテナンスで利用される  

### systemdの特徴
* 扱う処理をUnitという単位で管理する
* サービスの並列処理によって高速なシステム起動や停止が行える
* cgroupsでプロセスに割り当てるリソースを管理する

## プロセスの監視

psコマンド
| オプション | 説明 |
| - | - | 
| a | ほかのユーザのプロセスも表示 |
| f | プロセスの親子関係をツリー上で表示 |
| u | プロセスの実行ユーザ名も表示 |
| x | デーモン等のプロセスも表示 |
| -e | すべてのプロセスを表示 |
| -f | 完全なフォーマットでプロセスを表示 |
| -p | 指定したプロセスIDのプロセス情報を表示 |
| -l | 親プロセスのPIDや実行優先度を決定するnice値なども表示 |

## シグナル
プロセスの動作を中断させたり、再開、変更といった合図を送るための指定をシグナルという。  
シグナルはプロセスとプロセスの間で通信を行う際に使用される信号のこと  
シグナルを受け取ったプロセスは何等かの動作を行う。  
例えば、再起動や終了であったり  
Ctrl+CはSIGINTというシグナルを行うキー操作、Ctrl+ZはSIGTSTPというシグナルを行うキー操作  



シグナルの種類
| シグナル種別 | シグナルID | 内容 |
| - | - | - |
| TERM | 15 | 安全に終了させる |
| KILL | 9 | 強制終了させる |
| STOP | 19 | 中断させる |
| CONT | 18 | 再開させる |
| HUP | 1 | 変更を反映させる |
| QUIT | 3 | coreファイルを残しながら終了する |


プロセスIDを使用してプロセスにシグナルを送るにはkillコマンドを用いる

また、killallコマンドの場合、以下のようになる  
killall シグナル名or シグナル番号 プロセス名
killall -s シグナル名orシグナル番号 プロセス名


## カーネル
カーネルは高度にハードウェアを認識・制御し、ルートファイルシステムのマウントなど様々な初期化を行う
/sbin/initを起動する  


## Xサーバ
xサーバへの接続に使用される資格情報の表示やクライアント認証ファイルを編集するのにxauthコマンドを使用する  

startxコマンドをCUI環境(ランレベル３)で実行すると、X Window System(GUI環境)が起動する  

Xクライアント上で実行したプログラムをXサーバのディスプレイに表示させるには、以下の手順が必要  

1. Xサーバ側で、xhostコマンドでXクライアントからの接続を許可する
2. Xクライアント側で、環境変数DISPLAYで表示先（Xサーバ）を指定し、Xサーバに表示させたいプログラムを実行する

ウインドウマネージャとは、ウインドウの外観、アイコンやカーソル、メニューなどを提供するXクライアントのアプリケーション  
twmは最小限の機能を備えたウインドウマネージャ  

また、ディスプレイマネージャとはユーザにGUIログイン環境を提供する機能である  

XDMは、X.Org標準のディスプレイマネージャ  
GDMは、GNOME標準のディスプレイマネージャ
KDMは、KDE標準のディスプレイマネージャ  

## SUID
プログラムをどのユーザが実行しても、プログラムの所有ユーザ権限で実行されるようにするにはSUIDを設定する.  
設定方法はchmodコマンドで通常のパーミッションの値に4000を加えた値を設定するか、所有ユーザにsという権限を追加する  
chmod u+s file
chmod 4755 file

SUIDとは、誰がファイルを実行しても、セットされたユーザで実行されるということ。  
例えば、passwdコマンドは所有者はrootであり、SUIDが設定されている。これにより、root以外のどのユーザがpasswdコマンドを  
実行しても、rootが実行したことになる  

また、スティッキービットとは、設定されたファイルやディレクトリに対するアクションは可能だが、削除は所有者のみにしかできない  
ようにする設定  
設定方法は、通常のファイルのパーミッションに1000を追加するか、その他のユーザにo+tを追加するか

chmod o+t file
chmod 1755 file


## SGID
プログラムをどのグループが実行しても、プログラムの所有グループ権限で実行されるようになる設定  
設定方法は、通常のパーミッションに2000を追加する
chmod 2755 file
chmod g+s file

umaskのデフォルトのパーミッションのマスク値は666なので、umaskで222と設定すると、  
新規作成されたファイルに設定されるパーミッションは444となる

## tarコマンドによるアーカイブファイル作成

tarファイル
| オプション | 説明 |
| - | - |
| -c | 新しいアーカイブを作成 |
| -x | アーカイブからファイルを展開 | 
| -t | アーカイブの内容を一覧表示 | 
| -f | アーカイブファイル名を指定 | 
| -v | 処理の詳細情報を表示 |
| -z | gzipを通じて圧縮/展開 |
| -j | bzip2を通して圧縮/展開 | 
| -J | xzを通して圧縮/展開 |


## SQL
データベースから必要なデータを取得する言語
RDBに問い合わせるとデータが返ってくる  

## SQLがデータ分析で必要な理由
データ分析をするうえで、必要なデータを自分で収集するために使うから  

## データベースとは


sql-project-386714


## 外部結合
外部結合では、結合元のテーブルのデータはすべて残し、結合先のテーブルの値がある場合は、そのまま結合し、
値がない場合にはnullが入る。  

## サブクエリ
サブクエリとは、別のSQLクエリの実行結果を再利用すること  
⇒クエリの中にクエリを記述すること  

## 仮想テーブル
必要なときにクエリを実行できるクエリ（関数みたいな？？）  

WITH句をつかうことで、仮想テーブルを作成できる  

## 代表値の使い分け
平均値：分布が正規分布に近い場合、単純平均に適しているので、平均値を代表値とする
中央値：分布に外れ値が含まれている場合、平均値は使えないので、中央値が適している。
最頻値：あるデータの分布のみ突出している場合、最頻値が代表値に適している  

## 散布度

## 範囲：レンジ
データにおける最大値と最小値
## 偏差と分散
偏差とは、各データから平均値を引いた値  
偏差 = x - 平均値  

偏差を二乗して足し上げた値を偏差平方和という  
偏差平方和をデータ数で割れば、分散となる  
2つの集団のばらつきを比較できる  

平均からの距離 = 偏差  
分散のルートをとると、標準偏差になる  

例えば、以下の身長のデータがあった場合、  
平均：156.6cm  
分散：29.2   
標準偏差：5.4  
上記の場合、平均156.6cmから±5.4cm内に約68%の人数が当てはまるということになる  
⇒なんでXX%の値が標準偏差内に含まれるのだろうか？  


標準偏差が大きい：データのばらつきが多いということ
標準偏差が小さい：データのばらつきが少ないということ  

あるべき姿：従業員にとって、「働き甲斐がある会社」にしたい。「働き甲斐がある」と回答した社員が全体TOP２で７０％以上になりたい  

## データ分析
あるべき姿と分析目標を明確にする  

データ分析のポイント  

あるべき姿  
問題  
* 何が問題なのか
* なぜ問題が起きているのか
* どのように問題を解決するのか
* 何の問題から解決すべきなのか
解決策  

## 分析のポイント
* 分析目標を明確にする  
* 比較する
  * 相関を見る
  　　* 擬似相関に気を付ける
  * 原因を見つける（因果関係を見る）
    * 因果関係に含まれる根本原因が本当に根本原因かきちんと考えるべき
  * 単なる偶然
    * 発見した相関や因果に再現性がない場合、単なる偶然となる  
    * 


## 問題解決につながる分析のポイント２０
1. 現状分析はまず、ありたい姿、現状、問題の３つを把握する
2. さらに問題を何が問題か、なぜ問題が起きているのか、どのように問題を解決するのか、何の問題から解決するのか、の４つの視点で分析する
3. WHATは数字で、WHYは言葉で把握する
4. 数字 + 言葉 = 事実になる
5. 解決策の優先順位はビジネスインパクト * 実現可能性で考える
6. クロス集計では、結果に差が出そうな比較軸をあらかじめ想定しておくことが大切
7. 構造化は重なりに意味があることもある
8. 相関がみられたら、擬似相関を疑う
9. 関係性分析では、相関をみつけ、根本原因を抽出することが重要
10. 集団の特徴を表す数字には、代表値と散布度がある
11. 代表値である平均値・中央値・最頻値はデータの分布によって使い分ける
12. 最重要課題を見つけ、解決策を提案するのが、問題解決につながる分析

## データサイエンスとは
データから有用な情報・知識を引き出すための原理

## データマイニング
データサイエンスに基づく方法を活用して、でーたから有用な情報・知識を引き出すこと  

CRISP-DM(データマイニングプロセス)  

データ分析の中にデータマイニング、統計学、機械学習が含まれる  

## データ分析を活用したビジネス貢献
* 仮説検証による意思決定
  * とある施策の有効性を検証して継続の可否を助言
  * 現状のデータに基づいて有効な施策の提案と実行の確約
* モデル構築によるシステム自動化

## 統計と機械学習
* 統計学
  * ビジネスでは２つの統計がある
    * データから関心のある数値を算出する統計
      * 毎月の売り上げの平均を求める
      * 各事業所ごとの従業員の中央値を求める
    * 研究分野としての統計学
      * 記述統計：平均などの要約量を求めてデータの特徴を表現する
      * 推論統計：部分的なデータから全体の様子を推定する（検定など）
 * 機械学習
 
 ## 確率と事象
 事象：発生している出来事
 確率：事象が発生する回数/全事象が起こる場合の数  
 
 ## 確率変数と分布関数
 何等かの事象を入力すると、その確率が得られる関数を分布関数という。  
 確率変数とは、分布関数での確率に関する変数  
 
 期待値とは、すべての確率変数Xと分布関数P(X)の積の和  
 E(x) = siguma xP(x)  
 
 確率変数がどのくらいの値をとりそうかを考えるときに使う。  
 
 範囲に応じた確率を求める関数が確率密度関数という。  
 たとえば、企業の利益を確率変数とし、
 利益が1000万～3000万になる確率なら、この範囲の密度関数の下側の面積を求める  
 確率P(1000~3000)f(x)dx
 
 確率密度関数は、過去の経験から求めたり、事前に仮定したりする  
 
 期待値とは、１回やってみたときに、どれくらいのスコアが期待できるか、を考えること。  
 例えば、コイントスをして、表なら１点、裏なら０点のゲームがあった際に、表・裏が出る確率は0.5である場合、  
 １回のコイントスで手に入る得点はどのくらいになるのかを予測する際に期待値が使われる。  
 
 E(x) = 1 * 0.5 + 0 * 0.5
 となる。  
 
 また、さいころを１個振った時に出る目の期待値を求めるなら、  
 サイコロの各目が出る確率は1/6、確率変数は1～6の値をとるので、
 
 E(x) = 1 * 1/6 + 2 * 1/6 + 3 * 1/6 + 4 * 1/6 + 5 * 1/6 + 6 * 1/6
  = 7/2
  = 3.5
  となる。
  
  袋の中に赤玉６個、白玉３個、青玉１個がある。
  赤玉を引くと０円、白玉を引くと３００円、青玉を引くと１０００円もらえる。
  参加費が２００円のときに、このゲームに参加するのは得か、期待値で判断する場合、
  
  E(x) = (0 * 6/ 10 + 300 * 3/10 + 1000 * 1/10)
  = (90 + 100)
  = 190
  
  190 - 200
  = -10
  
  よって、１９０円しか見込めないから１０円損する期待値となる
 
 ## 推計統計
 データの背後にある全体の仕組みを推論する
 
 集めたデータは全データの一部であり、集めたデータから元の全データの性質を推測する
 
* 標本:集めたデータ（全体の一部）
* 母集団：標本のもととなる全体データ

つまり、母集団の一部のデータである標本から、母集団のデータの性質を推測するのが推計統計
 
 
## 母集団と標本
統計学では、問いの対象・知りたいことである母集団を標本から推測することが重要なテーマ  

## ヒストグラム
変数を可視化する基本の図  
x軸に変数の値をある一定の区間で区切る階級、y軸にその区間内に含まれている数値である度数が入っている。  

## 散布図
２つの変数の関係を可視化する図

## 記述統計
数十、数百の変数の中から代表している値を見つけること

## 代表値
その変数を代表する値
⇒数十、数百の変数の中から代表している値のこと。（平均、中央値、最頻値など）  


## 平均偏差
変数における平均的な中央値との距離
つまり、中央値からどのくらい変数が離れているのかがわかる
平均偏差= 各値と中央値の距離の合計 / 標本の大きさ  
= 4 + 0 + 2/ 3 = 2

## 分散
平均値から各変数のばらつきがどの程度なのかを表す指標  

2乗することで、計算が楽になる。  
⇒2乗することで、符号を意識しなくてよくなる。  

## 標準偏差
分散が平均値からばらついた値の２乗分離れていることを尺度を合すことができる  
標本から求めた分散を標本分散という。  

## 標準化
特定の平均と標準偏差となるような変数の変換
⇒２つの変数同士を比較する場合、それぞれの変数にはばらばらの平均と標準偏差であることが多い。
これでは、どちらの変数が優れているのか比較することができない。  
そのため、両変数の平均と標準偏差を統一することで、比較することができる。  
これを標準化という。  

方法は、  
1. 変数を平均で引く
2. 標準偏差で割る

## 点推定
標本統計量(推定量)で母数をピンポイントに推定する  

母集団には、母平均、母分散、母標準偏差などの母集団を特徴づける母数という値がある。これらを真値とも呼ぶ。  
対して、標本にも標本データ内で算出した標本平均、標本分散、不偏分散、標本標準偏差などのことを標本統計量という。  
は、標本データごとにこれらの値が変わることから、変動とも呼ぶ  
これらの標本統計量から母数をピンポイントで推定することを点推定という。  

## 不偏性
母集団から抽出した標本の標本統計量の期待値が母数と一致する性質  

## 平均の点推定
標本平均で母平均を点推定  
母集団から得られた標本データから標本平均を求める。この標本平均は、不偏性を持っている場合、母平均であるとそのまま推定することができる。  

## 分散の点推定
分散の点推定には不偏分散を用いる  
母集団から抽出した標本から標本分散を算出しても、標本分散には不偏性がないため、母分散として扱うことができない。  
そのため、不偏分散を用いる。  

点推定では信頼性が低いため、信頼性を上げるために区間推定を用いる  

## 単純無作為抽出
母集団からランダムに標本を抽出すること  
完全にランダムは難しいから、便宜的に段階に分けて抽出する  

## 確率モデル
データを母集団から確率的に発生させる装置みたいなもの  

## 確率変数
変数のうち、確率的に値が決まること
⇒表という変数が1/2の確率で抽出されること  

## 確率分布
確率変数のそれぞれの値が発生する確率の分布  
表にするなら、  

| 確率変数 | 表 | 裏 | 合計 |
----|---- | ---- | ----
| 確率 | 0.5 | 0.5 | 1 |  

グラフにする場合、横軸に確率変数、縦軸に確率変数に対応した発生する確率が記載される  

## 確率関数
確率関数は確率変数と発生確率のルールを数式化したもの  

## 二項分布
何回かコインを投げて表が出る回数が従う分布  

## 正規分布
正規分布は確率変数の真ん中が一番確率が高く、左右対称に分散していく確率分布の形状が正規分布  
正規分布は平均が中心である  

## 標準正規分布
平均0, 標準偏差1の正規分布  

## 母集団分布と標本分布  
標本分布から母集団分布を推定する場合には、母集団分布がしたがう分布の型と分布の型で扱うパラメータの値を推定する必要がある  

## 区間推定
母数が取る値を確率変数の区間で推定する。つまりは、100回中、95回はこの区間に値があると推定するといった感じ  

## 標準正規分布の両側5%点
100%を95%と5%に分ける点(境界ライン)：±1.96  
標準正規分布では、起こりにくい確率が±2.5%なので、残りの95%が起こりやすい確率だといわれている  

## 母平均の区間推定
母平均の区間推定を標本から算出する場合、以下を実施する。  
まず、母集団の前提条件として母集団の確率分布が正規分布に従うことを確認  
正規分布に従うのであれば、標本の確率変数も正規分布に従うことになる。  
この標本から母平均を区間推定するには、標本の正規分布を標準化して標準正規分布に変換する 
算出した標準正規分布から信頼区間95%（±1.96）の範囲内の値が母平均の範囲となる  

## 信頼度と信頼区間
信頼区間を含む確率を信頼度という。  
すなわち、信頼度95%というのは、標本を100回抽出した際に、信頼区間に母平均μを信頼区間に含む確率が95回、含まない確率が5回あるということ  
また、先ほどの±1.96という値の範囲内で信頼区間と信頼度を用いるには、正規分布を標準正規分布にしなければならない  


## 標本平均の性質
母集団から抽出した標本データが複数ある場合、正規分布は標準偏差が大きくなる傾向があるが、標準平均を取ることで、標準偏差を小さくできる  
そして、この各標本データの標本平均から作られる確率分布が正規分布になる。  

## 分散と信頼区間
分散（標準偏差）が小さい方が信頼区間を狭められる。つまりは、信頼区間内の確率変数の確率が大きくなることから、高精度な推定が期待できる  

## t分布
母分散が未知である場合、標本データの不偏分散を用いて区間推定を行う。この時、不偏分散を用いて区間推定するときに従う分布はt分布となる  
t分布のパラメータ「自由度=n-1」は、サンプル数nが大きい場合、標準正規分布に近い分布になる  
そのため、母分散が未知の場合にt分布を用いて区間推定することができる  


## 母集団分布が未知の場合
中心極限定理という標本が十分大きければ「標本平均」は正規分布にしたがう  
標本nが大体30以上あるとよい  

## 二値変数
コインの表と裏のように、結果が２通りのみのこと

## 比率
二値変数の平均
